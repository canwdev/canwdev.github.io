## 编译 一加6T(fajita) EDK2-UEFI 以修改分辨率

此教程来源于 Renegade Project：https://t.me/c/1184436601/90307

edk2项目：https://github.com/edk2-porting/edk2-sdm845
使用 Ubuntu 20.04 并安装文档中所有的依赖包，使用科学上网 clone git 项目可以完成编译。

第一次编译，不修改任何文件：
```sh
bash build.sh --device fajita
```

成功编译后会输出以下结果：
```sh
- Done -
Build end time: 21:40:54, Sep.04 2022
Build total time: 00:01:37

+ gzip -c
+ cat workspace/uefi-fajita.img.gz device_specific/fajita.dtb
+ python3 ./mkbootimg.py --kernel workspace/uefi-fajita.img.gz-dtb --ramdisk ramdisk --kernel_offset 0x00000000 --ramdisk_offset 0x00000000 --tags_offset 0x00000000 --os_version 12.0.0 --os_patch_level 2022-09 --header_version 1 -o /home/ubuntu/Projects/edk2-sdm845/boot-fajita.img
+ echo 'Build done: /home/ubuntu/Projects/edk2-sdm845/boot-fajita.img'
Build done: /home/ubuntu/Projects/edk2-sdm845/boot-fajita.img
+ set +x
```
项目目录下的 `boot-fajita.img` 就是 uefi 镜像了，可以直接刷入手机 boot 分区启动

修改配置文件：`sdm845Pkg/AcpiTables/legacy/enchilada_fajita/DSDT_fajita.dsl`
查找 `PRIMARY_SOURCE_MODES` 即可定位到分辨率配置（在48398行），与其他设备(*1*) 不同， 6T的数值是用16进制定义的，需要使用转换工具。

```javascript
// 使用浏览器控制台的 JS 进行转换：

// 10进制转16进制
hexString = yourNumber.toString(16);

// 16进制转10进制
yourNumber = parseInt(hexString, 16);
```

- 1. 其他设备：`sdm845Pkg/AcpiTables/beryllium/graphics.asl`
- 提示：可以使用 VSCode 的 `ASL` 插件来实现语法高亮，`Hex Hover Converter` 插件可以方便的转换16进制
- [分辨率计算器](https://www.omnicalculator.com/other/resolution-scale)

```
Package (0x0F)
                        {
                            "PRIMARY_SOURCE_MODES", 
                            0x0D,
                            Package (0x02)
                            {
                                0x0280, 
                                0x01E0
                            }, 
```

转换为 10进制后如下（？这里可以直接改为10进制并保存）
```
{
	"PRIMARY_SOURCE_MODES", 
    13, // <-- 注意这里
	Package (0x02)
	{
		640, // Width
		480 // Height
	}, 
```

注意这里：默认为13，下面有多少个 Package，就要将这个数字改为多少

？修改完 `DSDT_fajita.dsl` 后，需要将此文件编译为 `DSDT_fajita.aml`，执行命令：`iasl DSDT_fajita.dsl`

再次编译：`bash build.sh --device fajita`

推荐的分辨率：
```
10 for full:
600x480
800x600
1024x600
1024x768
1300x600
1430x660
1560x720
1733x800
1950x900
2340x1080
```

刷机，但没有任何效果，我也不知道为什么